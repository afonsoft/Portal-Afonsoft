!function(e){e(function(){e("#UserProfileBackToMyAccountButton").click(function(e){e.preventDefault(),abp.ajax({url:abp.appPath+"Account/BackToImpersonator",success:function(){app.supportsTenancyNameInUrl||abp.multiTenancy.setTenantIdCookie(abp.session.impersonatorTenantId)}})});var a=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/MySettingsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_MySettingsModal.js",modalClass:"MySettingsModal"});e("#UserProfileMySettingsLink").click(function(e){e.preventDefault(),a.open()}),e("#UserDownloadCollectedDataLink").click(function(e){e.preventDefault(),abp.services.app.profile.prepareCollectedData().done(function(){abp.message.success(app.localize("GdprDataPrepareStartedNotification"))})});var n=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/ChangePasswordModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_ChangePasswordModal.js",modalClass:"ChangePasswordModal"});e("#UserProfileChangePasswordLink").click(function(e){e.preventDefault(),n.open()});var t=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/ChangePictureModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_ChangePictureModal.js",modalClass:"ChangeProfilePictureModal"});e("#UserProfileChangePictureLink").click(function(e){e.preventDefault(),t.open()});var o=new app.ModalManager({viewUrl:abp.appPath+"App/Users/LoginAttemptsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Users/_LoginAttemptsModal.js",modalClass:"LoginAttemptsModal"});e("#ShowLoginAttemptsLink").click(function(e){e.preventDefault(),o.open()});var i=abp.services.app.userLink,s=new app.ModalManager({viewUrl:abp.appPath+"App/Profile/LinkedAccountsModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Profile/_LinkedAccountsModal.js",modalClass:"LinkedAccountsModal"}),r=function(){i.getRecentlyUsedLinkedUsers().done(function(a){!function(a){var n=e("ul#RecentlyUsedLinkedUsers");e.each(a.items,function(e,a){a.shownUserName=app.getShownLinkedUserName(a)}),a.hasLinkedUsers=function(){return this.items.length>0};var t=e("#linkedAccountsSubMenuTemplate").html();Mustache.parse(t);var o=Mustache.render(t,a);n.html(o)}(a),e("#ManageLinkedAccountsLink").click(function(e){e.preventDefault(),s.open()}),e(".recently-linked-user").click(function(a){a.preventDefault();var n,t,o=e(this).attr("data-user-id"),i=e(this).attr("data-tenant-id");o&&(n=o,t=i,abp.ajax({url:abp.appPath+"Account/SwitchToLinkedAccount",data:JSON.stringify({targetUserId:n,targetTenantId:t}),success:function(){app.supportsTenancyNameInUrl||abp.multiTenancy.setTenantIdCookie(t)}}))})})};s.onClose(function(){r()});var p=new app.UserNotificationHelper,c=abp.services.app.notification;function l(){c.getUserNotifications({maxResultCount:3}).done(function(a){a.notifications=[],a.unreadMessageExists=a.unreadCount>0,e.each(a.items,function(e,n){a.notifications.push(p.format(n))});var n=e("#header_notification_bar"),t=e("#headerNotificationBarTemplate").html();Mustache.parse(t);var o=Mustache.render(t,a);n.html(o),e("#setAllNotificationsAsReadLink").click(function(e){e.preventDefault(),e.stopPropagation(),p.setAllAsRead(function(){l()})}),e(".set-notification-as-read").click(function(a){a.preventDefault(),a.stopPropagation();var n=e(this).attr("data-notification-id");n&&p.setAsRead(n,function(){l()})}),e("#openNotificationSettingsModalLink").click(function(e){e.preventDefault(),e.stopPropagation(),p.openSettingsModal()}),e("div.user-notification-item-clickable").click(function(){var a=e(this).attr("data-url");document.location.href=a})})}abp.event.on("abp.notifications.received",function(e){p.show(e),l()}),abp.event.on("app.notifications.refresh",function(){l()}),abp.event.on("app.notifications.read",function(e){l()}),abp.event.on("app.chat.unreadMessageCountChanged",function(a){e("#chatIconUnRead .unread-notification-count").text(a),a?(e("#chatIconUnRead").removeClass("d-none"),e("#chatIcon").addClass("d-none")):(e("#chatIconUnRead").addClass("d-none"),e("#chatIcon").removeClass("d-none"))}),l(),r()})}(jQuery);