app.modals.CreateOrEditEditionModal=function(){var i,e,n=abp.services.app.edition,t=null;this.init=function(n){var a=(i=n).getModal();(e=new FeaturesTree).init(a.find(".feature-tree"));var d,s=a.find(".edition-list"),r=a.find(".SubscriptionPrice"),o=a.find(".trial-day-count"),c=a.find(".waiting-day-after-expire"),u=a.find(".paid-features"),f=a.find('.paid-features > .SubscriptionPrice input[name="DailyPrice"]'),p=a.find('.paid-features > .SubscriptionPrice input[name="WeeklyPrice"]'),l=a.find('.paid-features > .SubscriptionPrice input[name="MonthlyPrice"]'),m=a.find('.paid-features > .SubscriptionPrice input[name="AnnualPrice"]');function E(){a.find("#EditEdition_ExpireAction_AssignEdition").is(":checked")?s.slideDown("fast"):s.slideUp("fast")}function g(){a.find("#EditEdition_IsPaid").is(":checked")?(r.slideDown("fast"),u.slideDown("fast"),r.find("input").attr("required",!0)):(r.slideUp("fast"),u.slideUp("fast"),r.find("input").attr("required",!1))}function v(){a.find("#EditEdition_IsTrialActive").is(":checked")?o.slideDown("fast"):o.slideUp("fast")}function h(){a.find("#EditEdition_IsWaitingDayActive").is(":checked")?c.slideDown("fast"):c.slideUp("fast")}a.find("input[name=ExpireAction]").change(function(){E()}),a.find("input[name=SubscriptionPrice]").change(function(){g()}),a.find("#EditEdition_IsTrialActive").change(function(){v()}),a.find("#EditEdition_IsWaitingDayActive").change(function(){h()}),E(),g(),v(),h(),d={radixPoint:".",groupSeparator:",",digits:2,autoGroup:!0,prefix:$('input[name="currency"]').val()+" ",rightAlign:!1,showMaskOnHover:!1,showMaskOnFocus:!1,placeholder:"_",removeMaskOnSubmit:!0,autoUnmask:!0},f.inputmask("numeric",$.extend({},d)),p.inputmask("numeric",$.extend({},d)),l.inputmask("numeric",$.extend({},d)),m.inputmask("numeric",$.extend({},d)),(t=i.getModal().find("form[name=EditionInformationsForm]")).validate()},this.save=function(){if(t.valid())if(e.isValid()){var a=t.serializeFormToObject();i.setBusy(!0),n.createEdition({edition:a,featureValues:e.getFeatureValues()}).done(function(){abp.notify.info(app.localize("SavedSuccessfully")),i.close(),abp.event.trigger("app.createOrEditEditionModalSaved")}).always(function(){i.setBusy(!1)})}else abp.message.warn(app.localize("InvalidFeaturesWarning"))}};