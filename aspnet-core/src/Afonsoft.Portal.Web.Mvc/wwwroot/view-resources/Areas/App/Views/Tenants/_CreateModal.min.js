!function(e){e.validator.addMethod("tenancyNameRegex",function(e,n,t){return t.test(e)},app.localize("TenantName_Regex_Description")),app.modals.CreateTenantModal=function(){var n,t=abp.services.app.tenant,a=null,i=new app.PasswordComplexityHelper;this.init=function(t){var r=(n=t).getModal();(a=r.find("form[name=TenantInformationsForm]")).validate({rules:{TenancyName:{tenancyNameRegex:new RegExp(a.find("input[name=TenancyName]").attr("regex"))}}});var s=r.find("input[name=AdminPassword],input[name=AdminPasswordRepeat]"),o=s.closest(".form-group");i.setPasswordComplexityRules(s,window.passwordComplexitySetting),e("#CreateTenant_SetRandomPassword").change(function(){e(this).is(":checked")?(o.slideUp("fast"),s.removeAttr("required")):(o.slideDown("fast"),s.attr("required","required"))});var d=r.find("input[name=ConnectionString]"),c=d.closest(".form-group");e("#CreateTenant_UseHostDb").change(function(){e(this).is(":checked")?(c.slideUp("fast"),d.removeAttr("required")):(c.slideDown("fast"),d.attr("required","required"))}),r.find(".date-time-picker").datetimepicker({locale:abp.localization.currentLanguage.name,format:"L"});var p=r.find("input[name=SubscriptionEndDateUtc]").parent("div"),l=r.find("#CreateTenant_IsUnlimited"),u=r.find("input[name=SubscriptionEndDateUtc]");function m(){l.is(":checked")?(p.slideUp("fast"),u.removeAttr("required")):(p.slideDown("fast"),u.attr("required","required"))}l.change(function(){m()});var f=r.find("#EditionId");f.change(function(){var n="True"===e("option:selected",this).attr("data-isfree");""===e("option:selected",this).val()||n?(r.find(".subscription-component").slideUp("fast"),n?l.prop("checked",!0):l.prop("checked",!1)):r.find(".subscription-component").slideDown("fast")}),m(),f.trigger("change")},this.save=function(){if(a.valid()){var i=a.serializeFormToObject();e("#CreateTenant_IsUnlimited").is(":visible")&&!e("#CreateTenant_IsUnlimited").is(":checked")?i.SubscriptionEndDateUtc=e(".date-time-picker").data("DateTimePicker").date().format("YYYY-MM-DDTHH:mm:ss")+"Z":i.SubscriptionEndDateUtc=null,i.SetRandomPassword&&(i.Password=null,i.AdminPassword=null),i.UseHostDb&&(i.ConnectionString=null),n.setBusy(!0),t.createTenant(i).done(function(){abp.notify.info(app.localize("SavedSuccessfully")),n.close(),abp.event.trigger("app.createTenantModalSaved")}).always(function(){n.setBusy(!1)})}}}}(jQuery);