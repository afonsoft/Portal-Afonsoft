app.modals.InactivityControllerNotifyModal=function(){var t,o,n,i,a=this,e=abp.setting.getInt("App.UserManagement.SessionTimeOut.ShowTimeOutNotificationSecond"),l=e;function r(){a.Stop(),window.location.replace(abp.appPath+"Account/Logout")}function s(){--l<=0?(t.text("0s"),n.css("width","0%"),r()):(t.text(l+"s"),o.text(app.localize("SessionExpireRedirectingInXSecond",l)),n.css("width",parseInt(l/e*100)+"%"))}this.init=function(a){t=a.getModal().find("#countdown-holder"),o=a.getModal().find("#countdown-information"),n=a.getModal().find(".progress-bar"),t.text(e+"s"),n.css("width","100%"),i=setInterval(s,1e3)},this.Stop=function(){clearInterval(i),l=e}},app.modals.InactivityControllerNotifyModal.create=function(){var t=new app.ModalManager({viewUrl:abp.appPath+"App/Common/InactivityControllerNotifyModal",scriptUrl:abp.appPath+"view-resources/Areas/App/Views/Common/Modals/_InactivityControllerNotifyModal.js",modalClass:"InactivityControllerNotifyModal"}),o=t.close;return t.close=function(){t.getModalObject().Stop(),o()},t};
var InactivityController=function(){var t,e,o=app.modals.InactivityControllerNotifyModal.create();var n=!0;function i(){n=!0}function a(){r(),function(){var n=0;n=localStorage?localStorage.getItem(t):abp.utils.getCookieValue(t);if(Date.now()-n<=1e3*e)return void(l&&(o.close(),l=!1));l||(o.open(),l=!0)}()}function r(){n&&(localStorage?localStorage.setItem(t,Date.now()):abp.utils.setCookieValue(t,Date.now())),n=!1}var l=!1;return{init:function(o){t=o.lastActivityTimeStorageKey?o.lastActivityTimeStorageKey:"UserLastActivity",e=o.InActivityControlSecond,window.onmousemove=i,window.onmousedown=i,window.onclick=i,window.onscroll=i,window.onkeypress=i,r(),setInterval(a,1e3)}}}();jQuery(document).ready(function(){abp.setting.getBoolean("App.UserManagement.SessionTimeOut.IsEnabled")&&InactivityController.init({lastActivityTimeStorageKey:"UserLastActivity",InActivityControlSecond:abp.setting.getInt("App.UserManagement.SessionTimeOut.TimeOutSecond")})});